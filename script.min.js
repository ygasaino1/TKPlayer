let r=null,l=document.querySelector("#video-iframe"),s=document.querySelector("#vid-container"),O=document.querySelector("#twitch-container"),c=null,T=document.querySelector("#back-container"),o=document.querySelector("#back-iframe"),t=document.querySelector("audio"),d,u=null,m="",i=document.querySelector("#console-input"),n=document.querySelector("#console"),a=document.querySelector("#console-flex"),S="#ffd3dc",h="#00b1ff",e,U=1e3,p=100,V=.8,g=!1;function console_(e,o=S){o=htmlToElement(`<div class="console" style="color: ${o}">${e}</div>`);for(i.appendChild(o);n.scrollHeight>n.clientHeight&&2<i.childNodes.length;)i.childNodes[1].remove()}function showConsole(){n.style.zIndex=p,g||(clearTimeout(e),e=setTimeout(()=>{n.style.zIndex="0"},U))}function htmlToElement(e){var o=document.createElement("template");return e=e.trim(),o.innerHTML=e,o.content.firstChild}function bilibili_main(){console.log(">> inside bilibili_main"),console.log(u),console.log(P.param);var e=/\/video\/(\w+)|bvid=(\w+)/i,o=decodeURI(u.href);let t="",i=(e.test(o)&&(o=o.match(e),t=o[1]||o[2]||""),parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0);"t"in P.param&&(i+=parseInt(P.param.t)||0),bilibili_call(`https://player.bilibili.com/player.html?&bvid=${t}&page=1&autoplay=1&t=`+i)}function bilibili_call(e){console.log(e),l.setAttribute("src",e),console.log(l)}function mixcloud_main(){console.log(">> inside mixcloud_main"),console.log(u),console.log(P.param);var e=/\/([\w-]+)\/([\w-]+)\/?$/i,o=decodeURI(u.href);let t="",i="",n=(e.test(o)&&(3<=(o=o.match(e)).length?"live"==o[1].toLowerCase()?t=o[2]||"":(t=o[1]||"",i=o[2]||""):script_direct()),parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0);"t"in P.param&&(n+=parseInt(P.param.t)||0),t&&i?(e=`https://www.mixcloud.com/widget/iframe/?feed=/${t}/${i}/`,l.setAttribute("src",e),(_=_||mixcloud_initialization()).then(()=>{(r=Mixcloud.PlayerWidget(document.getElementById("video-iframe"))).ready.then(function(){r.events.ended.on(()=>{0<x.length||!("loop"in P.param)?sessionEnded():(r.seek(0),r.play())}),mixcloud_call(n)})})):script_direct()}function mixcloud_call(e){console.log(">> inside mixcloud_call"),r.play(),r.setOption("hide_cover",!0),0!=e&&r.seek(e)}String.prototype.replaceAt=function(e,o){return this.substring(0,e)+o+this.substring(e+1)};let _=null;function mixcloud_initialization(){return new Promise((e,o)=>{var t=document.createElement("script"),i=(t.id="mixcloud-script",t.src="https://widget.mixcloud.com/media/js/widgetApi.js",t["async"]=!0,t.onload=()=>{e()},document.getElementsByTagName("script")[0]);i.parentNode.insertBefore(t,i),console_("___ Mixcloud Initialization...")})}function soundcloud_main(){console.log(">> inside soundcloud_main"),console.log(u),console.log(P.param),soundcloud_call(`https://w.soundcloud.com/player/?url=${decodeURI(u.href)}&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true`)}function soundcloud_call(e){console.log(e),l.setAttribute("src",e),console.log(l)}function twitch_main(){console.log(">> inside twitch_main"),console.log(u),console.log(P.param),r=null;var o=/^.*www\.twitch\.tv\/([^\?\/]+)$|.*\/\?channel=([^&]*)/i,t=/.*\/\?video=(\w+)|.*\/videos\/([^?]*)/i,i=/.*collection=(\w+)/i,n=decodeURI(u.href);let e="",l="",a="",s="";if(o.test(n)&&(o=n.match(o),l=o[1]||o[2]||"",console.log("twitch@channel_id: "+l)),t.test(n)){let e=n.match(t);a=e[1]||e[2]||"",console.log("twitch@video_id: "+a)}if(i.test(n)){let e=n.match(i);s=e[1]||"",console.log("twitch@collection_id: "+s)}e=`https://player.twitch.tv/?parent=${d.hostname}&autoplay=true`,""!=l&&(e+="&channel="+l),""!=a&&(e+="&video="+a),""!=s&&(e+="&collection="+s);let c=0;o=u.searchParams.get("t")||u.searchParams.get("time")||"";if(/^.*\D.*$/.test(o)){let e=o.match(/(\d*h)?(\d*m)?(\d*s)/i);c=(c=(c+=3600*parseInt(e[1])||0)+(60*parseInt(e[2])||0))+(parseInt(e[3])||0)}else c=parseInt(o)||0;"t"in P.param&&(c+=parseInt(P.param.t)||0),e+="&time="+c;t={autoplay:!0,width:"100%",height:"100%"};""!=l?t.channel=l:""!=a?t.video=a:""!=s&&(t.collection=s),0!=c&&(t.time=""+c),(r=new Twitch.Player("twitch-container",t)).addEventListener(Twitch.Player.VIDEO_PLAY,setTwitchQuality),r.addEventListener(Twitch.Player.ENDED,twitchEnded)}function setTwitchQuality(){var e;console.log("twitch: Play"),r.removeEventListener(Twitch.Player.VIDEO_PLAY,setTwitchQuality),"max"in P.param&&(e="twitch: Setting quality...",console.log(e),console_(e),e=r.getQualities().length+" Qualities Present",console.log(e),console_(e),1<r.getQualities().length)&&(e=""+r.getQualities()[1].group,console.log("quality: "+e),console_("quality: "+e),r.setQuality(e))}function twitchEnded(){sessionEnded()}function vimeo_main(){console.log(">> inside vimeo_main"),console.log(u),console.log(P.param);let e="";video_reg=/\/(\w+)[^\/]*$/i;var o=decodeURI(u.href);let t="";video_reg.test(o)&&(o=o.match(video_reg),t=o[1]||o[2]||"",console.log("vimeo@video_id: "+t)),vimeo_call(e="loop"in P.param?`https://player.vimeo.com/video/${t}?autoplay=1&loop=1&autopause=0`:`https://player.vimeo.com/video/${t}?autoplay=1`)}function vimeo_call(e){console.log(e),l.setAttribute("src",e),console.log(l)}function wistia_main(){console.log(">> inside wistia_main"),console.log(u),console.log(P.param);decodeURI(u.href);wistia_call("")}function wistia_call(e){console.log(e),l.setAttribute("src",e),console.log(l)}let L="AIzaSyASq2_wSS45nCkxTy71WW5CKAhPzRn6pHU",y=null,C=["playVideo()","pauseVideo()","stopVideo()","clearVideo()","nextVideo()","previousVideo()","mute()","unMute()","setVolume(vol)","seekTo(time)","setPlaybackRate(rate)","showVideoInfo()","hideVideoInfo()"];function YouTubeGetID(e){return(void 0!==(e=e.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/|\/shorts\/)/))[2]?e[2].split(/[^0-9a-z_\-]/i):e)[0]}let f=-1;function youtube_main(){console.log(">> inside youtube_main"),console.log(u),console.log(P.param);var i=decodeURI(u.href);let n="",e="";if("list"in P.param||u.pathname.toLowerCase().includes("videoseries"))i.includes("list=LL")||i.toLowerCase().includes("start_radio=1")||(u.searchParams.has("playlist")&&(e=u.searchParams.get("playlist")),u.searchParams.has("list")&&(e=u.searchParams.get("list")),n="loop"in P.param?`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&loop=1&`:`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&`);else if(""==e){i=YouTubeGetID(i),console.log("youtube@video_id: "+i);let e=parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0,o=("t"in P.param&&(e+=parseInt(P.param.t)||0),f=-1,e),t=-1;if("crop"in P.param){var l=P.param.crop.split("-");try{f=Number(l[0]),o+=Number(l[0])}catch(a){console_(a)}try{1<l.length&&(t=Number(l[1]))}catch(a){console_(a)}}n=`https://www.youtube.com/embed/${i}?enablejsapi=1&controls=0&start=`+o,-1!=t&&(n+="&end="+t)}"mute"in P.param&&(n+="&mute=1"),y=P.param,youtube_call(n)}function youtube_call(e){console.log(e),l.setAttribute("src",e),b||youtube_initialization(),console.log(l)}let b=!1;function youtube_initialization(){var e=document.createElement("script"),o=(e.id="iframe-demo",e.src="https://www.youtube.com/iframe_api",document.getElementsByTagName("script")[0]);o.parentNode.insertBefore(e,o),b=!0}function onYouTubeIframeAPIReady(){var e={events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}};r=new YT.Player("video-iframe",e)}function onPlayerReady(e){r.playVideo(),setYoutubePlaybackRate(),setYoutubeVolume()}"no-source"!=l.getAttribute("src")&&youtube_initialization();let w=[0,0,0];function onPlayerStateChange(e){var o;w.unshift(e.data),w.pop(),w[0]==YT.PlayerState.PLAYING&&w[1]==YT.PlayerState.BUFFERING&&w[2]==YT.PlayerState.UNSTARTED&&(o=r.videoTitle,console_(`___ [${document.title=o}]`),console_(`___ [${r.getDuration()}]`)),e.data==YT.PlayerState.ENDED&&0<x.length?sessionEnded():e.data==YT.PlayerState.ENDED&&"loop"in y&&!("list"in y)&&(r.playVideo(),-1!=f)&&r.seekTo(f)}function setYoutubePlaybackRate(){let o=null;Object.keys(P.param).forEach(e=>{e=e.match(/^(\d+\.?\d*)x$/i);e&&1<e.length&&(o=Number(e[1]))}),o&&r.setPlaybackRate(o)}function setYoutubeVolume(){let o=null;Object.keys(P.param).forEach(e=>{e=e.match(/^(\d+\.?\d*)v$/i);e&&1<e.length&&(o=Number(e[1]))}),o&&(100<(o=o<0?0:o)&&(o=100),r.setVolume(o))}function zeno_main(){console.log(">> inside zeno_main"),console.log(u),console.log(P.param);var e=decodeURI(u.href);let o="";(radio_reg=/\/(\w+)\/?$/i).test(e)&&(e=e.match(radio_reg),o=e[1]||"",console.log("zeno@radio_id: "+o)),zeno_call("https://zeno.fm/player/"+o)}function zeno_call(e){console.log(e),l.setAttribute("src",e),console.log(l)}function cmd_comment(n){let e=1;n.toLowerCase().startsWith("waa",5)&&(e=3,n=n.replace(n.substring(5,9),""));for(let i=0;i<e;i++){let e=$(`<p id="back">${n}</p>`),o=$(`<p id="front">${n}</p>`);var l=Math.random()*(window.innerHeight-200);let t=0;0<i&&(t=1e3*Math.random()),e.css("position","absolute"),e.css("left",window.innerWidth+t),e.css("top",l),e.css("white-space","pre"),o.css("position","absolute"),o.css("left",window.innerWidth+t),o.css("top",l),o.css("white-space","pre"),e.appendTo("body"),o.appendTo("body"),e.animate({left:-1*e.width()},7e3,"linear",function(){e.remove()}),o.animate({left:-1*o.width()},7e3,"linear",function(){o.remove()})}}function script_direct(){console.log(">> inside direct"),console.log(u),console.log(P.param),script_call(decodeURI(u.href))}function script_call(e){console.log(e),window.location.href=e}function radio_main(){console.log(">> inside audio_main"),console.log(u),console.log(P.param),radio_call(decodeURI(u.href))}function radio_call(e){console_(m="Radio Loading..."),console.log(e),t.setAttribute("src",e),t.play(),console.log(t)}function video_main(){console.log(">> inside video_main"),console.log(u),console.log(P.param);let t=decodeURI(u.href);c=htmlToElement('<video-js id="my-video" class="video-js" style="position: absolute; top:0; left:0; height:100%; width:100%" autoplay preload="auto"></video-js>'),console.log(c),s.appendChild(c),console_(m="Video Loading..."),r=videojs(document.querySelector("#my-video"));var e={m3u8:"application/x-mpegURL",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg"};let i=t,o="",n,l=!1,a=(Object.keys(e).forEach(e=>{!l&&i.toLowerCase().includes(e)&&(o=e,l=!0)}),!1);Object.keys(e).forEach(e=>{!a&&e in P.param&&(o=e,a=!0)}),o in e&&(n=e[o],r.ready(function(){console.log("VideoJs is Ready..."),console_(`___ [${n}]`),console.log(`___ [${n}]`),console.log("[SRC] "+i);var e={type:n,src:i},e=(console.log(e),r.src(e),new URL(t));let o=parseInt(e.searchParams.get("t"))||parseInt(e.searchParams.get("time"))||0;"t"in P.param&&(o+=parseInt(P.param.t)||0),this.currentTime(o)})),r.on("ended",function(){videojs.log("Awww...over so soon?!"),c.remove(),c=null,sessionEnded()})}r=null;let D="https://prrr-001.glitch.me/",A=window.location.href,z="",v=0,I=(d=new URL(location),{}),E={youtube:/(.*youtube\..*)|(.*youtu\.be.*)/i,twitch:/.*\.twitch\..*/i,vimeo:/.*vimeo\.\w+\//i,soundcloud:/\w*.?soundcloud\.\w+/i,bilibili:/\.bilibili\./i,zeno:/zeno/i,mixcloud:/\.mixcloud\./i,video:/\.mp4|\.m3u8|\.webm|\.ogv/i},R={radio:radio_main};function cmd_open_v2(){let e=P.body;m="...REQUEST",""!=P.id&&(m+="@"+P.id),console_(m);try{u=null,"off"==e?(e=A,u=new URL(e),console_("URL off")):"homepage"==e?(e=D,u=new URL(e),console_("URL homepage")):(u=new URL(e),console_(m=u.host==location.host||"-"in P.param?"URL [*][*][*][*][*] -{___}":`URL [${u.protocol}//][${u.host}][${u.pathname}][${u.search}][${u.hash}] -`+JSON.stringify(P.param))),prehub(),showConsole()}catch(o){console.log("URL Failed"),null==u&&console_(`URL ${P.body} -`+JSON.stringify(P.param),h),console_(o,h),console_("...URL Failed",h),showConsole()}}function prehub(){(["radio"].some(e=>e in P.param)?(reload_check("NOVIDEO"),cleanup("NOVIDEO"),restyle("NOVIDEO"),hub_novideo):(reload_check("VIDEO"),cleanup("VIDEO"),restyle("VIDEO"),hub_video))()}function reload_check(e){0<v&&!("noreload"in P.param)&&window.location.reload(),"VIDEO"==e&&(v+=1)}function cleanup(e){"VIDEO"==e?(null!=c&&(c.remove(),c=null),l.setAttribute("src",""),"mute"in P.param||t.setAttribute("src","")):"NOVIDEO"==e&&t.setAttribute("src","")}function restyle(e){"debug"in P.param?n.style.zIndex=p:n.style.zIndex=0,"VIDEO"==e?(a.style.backgroundColor=`rgb(0,0,0,${V})`,o.setAttribute("src","")):"NOVIDEO"==e&&(a.style.backgroundColor="rgb(0,0,0,0.0)",o.setAttribute("src","flow\\index.html"))}function hub_video(){var e=Object.keys(I).filter(e=>e in P.param)[0];null!=e?I[e]():(E.youtube.test(u.host)?youtube_main:E.twitch.test(u.host)?twitch_main:E.vimeo.test(u.host)?vimeo_main:E.soundcloud.test(u.host)?soundcloud_main:E.bilibili.test(u.host)?bilibili_main:E.zeno.test(decodeURI(u.host))?zeno_main:E.mixcloud.test(decodeURI(u.host))?mixcloud_main:E.video.test(decodeURI(u.href))?video_main:script_direct)()}function hub_novideo(){var e=Object.keys(R).filter(e=>e in P.param)[0];null!=e&&R[e]()}function cmd_debug(){"0"==n.style.zIndex?(g=!0,n.style.zIndex=p):(g=!1,n.style.zIndex="0")}window.addEventListener("hashchange",()=>{hashchange(!1)});let P={overparam:{},func:"default",body:"",param:{},id:"",extra:{}};function hashchange(e){0==e&&0==hashVerified()||("comment"==P.func?cmd_comment(P.body):"debug"==P.func?cmd_debug():"default"==P.func&&("que"in P.param?cmd_que:"cmd"in P.param?cmd_cmd:"help"in P.param?cmd_help:cmd_open_v2)(),history.pushState(null,null," "))}function hashVerified(){var e=decodeURI(location.hash).substring(1);console.log("#"+e);try{let o=JSON.parse(e);return P={overparam:{},func:"default",body:"",param:{},id:"",extra:{}},Object.keys(o).forEach(e=>{e in P&&null!=o[e]&&(P[e]=o[e])}),Object.keys(P.overparam).forEach(e=>{P.param[e]=P.overparam[e]}),delete P.overparam,console.log("> Hash Verified."),console.log(P),!0}catch(o){return!1}}let x=[];function cmd_que(){delete P.param.que,P.param.noreload=null,x.push(P),m="...QUE-REQUEST",""!=P.id&&(m+="@"+P.id),console.log(m),console_(m),showConsole()}function sessionEnded(){console.log("> Session End!"),0<x.length&&(P=x.shift(),hashchange(!0))}function cmd_cmd(){m="...CMD-REQUEST",""!=P.id&&(m+="@"+P.id),console_(m),P.body=cmd_cmd_security(P.body);try{var e=`"use strict";player.${P.body};`;Function(e)(),console.log(e),console_("CMD player."+P.body),showConsole()}catch(o){console.log("CMD Failed"),console_(o,h),console_("...CMD Failed",h),showConsole()}}function cmd_cmd_security(e){e=(e=e.replace(/[;\.\s]/g,"")).substring(0,-1==e.indexOf(")")?e.length:e.indexOf(")")+1);let o=-1;for(;-1!=(o=e.indexOf(",",o+1));){var t,i=e.indexOf(")",o);-1==i?e=e.replaceAt(o,""):(-1!=(t=e.indexOf("(",o))&&t<i||-1==t&&-1==e.indexOf("(",0))&&(e=e.replaceAt(o,""))}return e}function cmd_help(){"youtube"==P.body.toLowerCase()&&(console_(JSON.stringify(C,null,1)),showConsole())}l.style.visibility="visible",hashchange(!(s.style.visibility="visible"));