let c=null,a=document.querySelector("#video-iframe"),s=document.querySelector("#vid-container");document.querySelector("#twitch-container");let r=null;document.querySelector("#back-container");let o=document.querySelector("#back-iframe"),t=document.querySelector("audio"),d,u=null,m="",i=document.querySelector("#console-input"),p=document.querySelector("#console"),l=document.querySelector("#console-flex"),C="#ffd3dc",h="#00b1ff",e,T=1e3,g=100,k=.8,f=!1;function y(e,o=C){o=w(`<div class="console" style="color: ${o}">${e}</div>`);for(i.appendChild(o);p.scrollHeight>p.clientHeight&&2<i.childNodes.length;)i.childNodes[1].remove()}function v(){p.style.zIndex=g,f||(clearTimeout(e),e=setTimeout(()=>{p.style.zIndex="0"},T))}function w(e){var o=document.createElement("template");return e=e.trim(),o.innerHTML=e,o.content.firstChild}function q(){console.log(">> inside bilibili_main"),console.log(u),console.log(A.param);var e=/\/video\/(\w+)|bvid=(\w+)/i,o=decodeURI(u.href);let t="",i=(e.test(o)&&(o=o.match(e),t=o[1]||o[2]||""),parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0);"t"in A.param&&(i+=parseInt(A.param.t)||0),e=`https://player.bilibili.com/player.html?&bvid=${t}&page=1&autoplay=1&t=`+i,o=e,console.log(o),a.setAttribute("src",o),console.log(a)}function z(){console.log(">> inside mixcloud_main"),console.log(u),console.log(A.param);var e=/\/([\w-]+)\/([\w-]+)\/?$/i,o=decodeURI(u.href);let t="",i="",l=(e.test(o)&&(3<=(o=o.match(e)).length?"live"==o[1].toLowerCase()?t=o[2]||"":(t=o[1]||"",i=o[2]||""):O()),parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0);"t"in A.param&&(l+=parseInt(A.param.t)||0),t&&i?(e=`https://www.mixcloud.com/widget/iframe/?feed=/${t}/${i}/`,a.setAttribute("src",e),(n=n||new Promise((e,o)=>{var t=document.createElement("script"),i=(t.id="mixcloud-script",t.src="https://widget.mixcloud.com/media/js/widgetApi.js",t.async=!0,t.onload=()=>{e()},document.getElementsByTagName("script")[0]);i.parentNode.insertBefore(t,i),y("___ Mixcloud Initialization...")})).then(()=>{(c=Mixcloud.PlayerWidget(document.getElementById("video-iframe"))).ready.then(function(){var e;c.events.ended.on(()=>{0<N.length||!("loop"in A.param)?j():(c.seek(0),c.play())}),e=l,console.log(">> inside mixcloud_call"),c.play(),c.setOption("hide_cover",!0),0!=e&&c.seek(e)})})):O()}String.prototype.replaceAt=function(e,o){return this.substring(0,e)+o+this.substring(e+1)};let n=null;function M(){console.log(">> inside soundcloud_main"),console.log(u),console.log(A.param);var e=decodeURI(u.href);e=`https://w.soundcloud.com/player/?url=${e}&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true`,console.log(e),a.setAttribute("src",e),console.log(a)}function b(){var e;console.log("twitch: Play"),c.removeEventListener(Twitch.Player.VIDEO_PLAY,b),"max"in A.param&&(e="twitch: Setting quality...",console.log(e),y(e),e=c.getQualities().length+" Qualities Present",console.log(e),y(e),1<c.getQualities().length)&&(e=""+c.getQualities()[1].group,console.log("quality: "+e),y("quality: "+e),c.setQuality(e))}function Q(){j()}function B(){console.log(">> inside vimeo_main"),console.log(u),console.log(A.param);let e="";video_reg=/\/(\w+)[^\/]*$/i;var o=decodeURI(u.href);let t="";video_reg.test(o)&&(o=o.match(video_reg),t=o[1]||o[2]||"",console.log("vimeo@video_id: "+t)),e="loop"in A.param?`https://player.vimeo.com/video/${t}?autoplay=1&loop=1&autopause=0`:`https://player.vimeo.com/video/${t}?autoplay=1`,o=e,console.log(o),a.setAttribute("src",o),console.log(a)}let F=null,H=["playVideo()","pauseVideo()","stopVideo()","clearVideo()","nextVideo()","previousVideo()","mute()","unMute()","setVolume(vol)","seekTo(time)","setPlaybackRate(rate)","showVideoInfo()","hideVideoInfo()"];let I=-1;function J(){console.log(">> inside youtube_main"),console.log(u),console.log(A.param);var i=decodeURI(u.href);let l="",e="";var n="";if("list"in A.param||u.pathname.toLowerCase().includes("videoseries"))i.includes("list=LL")||i.toLowerCase().includes("start_radio=1")||(u.searchParams.has("playlist")&&(e=u.searchParams.get("playlist")),u.searchParams.has("list")&&(e=u.searchParams.get("list")),l="loop"in A.param?`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&loop=1&`:`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&`);else if(""==e){n=(void 0!==(i=(i=i).split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/|\/shorts\/)/))[2]?i[2].split(/[^0-9a-z_\-]/i):i)[0],console.log("youtube@video_id: "+n);let e=parseInt(u.searchParams.get("t"))||parseInt(u.searchParams.get("time"))||0,o=("t"in A.param&&(e+=parseInt(A.param.t)||0),I=-1,e),t=-1;if("crop"in A.param){i=A.param.crop.split("-");try{I=Number(i[0]),o+=Number(i[0])}catch(e){y(e)}try{1<i.length&&(t=Number(i[1]))}catch(e){y(e)}}l=`https://www.youtube.com/embed/${n}?enablejsapi=1&controls=0&start=`+o,-1!=t&&(l+="&end="+t)}"mute"in A.param&&(l+="&mute=1"),F=A.param;i=l;console.log(i),a.setAttribute("src",i),_||E(),console.log(a)}let _=!1;function E(){var e=document.createElement("script"),o=(e.id="iframe-demo",e.src="https://www.youtube.com/iframe_api",document.getElementsByTagName("script")[0]);o.parentNode.insertBefore(e,o),_=!0}"no-source"!=a.getAttribute("src")&&E();function W(){console.log(">> inside zeno_main"),console.log(u),console.log(A.param);var e=decodeURI(u.href);let o="";(radio_reg=/\/(\w+)\/?$/i).test(e)&&(e=e.match(radio_reg),o=e[1]||"",console.log("zeno@radio_id: "+o)),e="https://zeno.fm/player/"+o,e=e,console.log(e),a.setAttribute("src",e),console.log(a)}function O(){console.log(">> inside direct"),console.log(u),console.log(A.param);var e=decodeURI(u.href);e=e,console.log(e),window.location.href=e}c=null;let Y="https://prrr-001.glitch.me/",G=window.location.href;let R=0,U=(d=new URL(location),{}),x={youtube:/(.*youtube\..*)|(.*youtu\.be.*)/i,twitch:/.*\.twitch\..*/i,vimeo:/.*vimeo\.\w+\//i,soundcloud:/\w*.?soundcloud\.\w+/i,bilibili:/\.bilibili\./i,zeno:/zeno/i,mixcloud:/\.mixcloud\./i,video:/\.mp4|\.m3u8|\.webm|\.ogv/i},L={radio:function(){console.log(">> inside audio_main"),console.log(u),console.log(A.param);var e=decodeURI(u.href);e=e,y(m="Radio Loading..."),console.log(e),t.setAttribute("src",e),t.play(),console.log(t)}};function K(){let e=A.body;m="...REQUEST",""!=A.id&&(m+="@"+A.id),y(m);try{u=null,"off"==e?(e=G,u=new URL(e),y("URL off")):"homepage"==e?(e=Y,u=new URL(e),y("URL homepage")):(u=new URL(e),y(m=u.host==location.host||"-"in A.param?"URL [*][*][*][*][*] -{___}":`URL [${u.protocol}//][${u.host}][${u.pathname}][${u.search}][${u.hash}] -`+JSON.stringify(A.param))),(["radio"].some(e=>e in A.param)?(P("NOVIDEO"),V("NOVIDEO"),S("NOVIDEO"),function(){var e=Object.keys(L).filter(e=>e in A.param)[0];null!=e&&L[e]()}):(P("VIDEO"),V("VIDEO"),S("VIDEO"),function(){var e=Object.keys(U).filter(e=>e in A.param)[0];null!=e?U[e]():(x.youtube.test(u.host)?J:x.twitch.test(u.host)?function(){console.log(">> inside twitch_main"),console.log(u),console.log(A.param),c=null;var e=/^.*www\.twitch\.tv\/([^\?\/]+)$|.*\/\?channel=([^&]*)/i,o=/.*\/\?video=(\w+)|.*\/videos\/([^?]*)/i,t=/.*collection=(\w+)/i,i=decodeURI(u.href);let l="",n="",a="",s="",r=(e.test(i)&&(e=i.match(e),n=e[1]||e[2]||"",console.log("twitch@channel_id: "+n)),o.test(i)&&(e=i.match(o),a=e[1]||e[2]||"",console.log("twitch@video_id: "+a)),t.test(i)&&(o=i.match(t),s=o[1]||"",console.log("twitch@collection_id: "+s)),l=`https://player.twitch.tv/?parent=${d.hostname}&autoplay=true`,""!=n&&(l+="&channel="+n),""!=a&&(l+="&video="+a),""!=s&&(l+="&collection="+s),0);e=u.searchParams.get("t")||u.searchParams.get("time")||"",r=/^.*\D.*$/.test(e)?(i=e.match(/(\d*h)?(\d*m)?(\d*s)/i),(r=(r+=3600*parseInt(i[1])||0)+(60*parseInt(i[2])||0))+(parseInt(i[3])||0)):parseInt(e)||0,"t"in A.param&&(r+=parseInt(A.param.t)||0),l+="&time="+r,t={autoplay:!0,width:"100%",height:"100%"},""!=n?t.channel=n:""!=a?t.video=a:""!=s&&(t.collection=s),0!=r&&(t.time=""+r),(c=new Twitch.Player("twitch-container",t)).addEventListener(Twitch.Player.VIDEO_PLAY,b),c.addEventListener(Twitch.Player.ENDED,Q)}:x.vimeo.test(u.host)?B:x.soundcloud.test(u.host)?M:x.bilibili.test(u.host)?q:x.zeno.test(decodeURI(u.host))?W:x.mixcloud.test(decodeURI(u.host))?z:x.video.test(decodeURI(u.href))?function(){console.log(">> inside video_main"),console.log(u),console.log(A.param);let t=decodeURI(u.href);r=w('<video-js id="my-video" class="video-js" style="position: absolute; top:0; left:0; height:100%; width:100%" autoplay preload="auto"></video-js>'),console.log(r),s.appendChild(r),y(m="Video Loading..."),c=videojs(document.querySelector("#my-video"));var e={m3u8:"application/x-mpegURL",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg"};let i=t,o="",l,n=!1,a=(Object.keys(e).forEach(e=>{!n&&i.toLowerCase().includes(e)&&(o=e,n=!0)}),!1);Object.keys(e).forEach(e=>{!a&&e in A.param&&(o=e,a=!0)}),o in e&&(l=e[o],c.ready(function(){console.log("VideoJs is Ready..."),y(`___ [${l}]`),console.log(`___ [${l}]`),console.log("[SRC] "+i);var e={type:l,src:i},e=(console.log(e),c.src(e),new URL(t));let o=parseInt(e.searchParams.get("t"))||parseInt(e.searchParams.get("time"))||0;"t"in A.param&&(o+=parseInt(A.param.t)||0),this.currentTime(o)})),c.on("ended",function(){videojs.log("Awww...over so soon?!"),r.remove(),r=null,j()})}:O)()}))(),v()}catch(e){console.log("URL Failed"),null==u&&y(`URL ${A.body} -`+JSON.stringify(A.param),h),y(e,h),y("...URL Failed",h),v()}}function P(e){0<R&&!("noreload"in A.param)&&window.location.reload(),"VIDEO"==e&&(R+=1)}function V(e){"VIDEO"==e?(null!=r&&(r.remove(),r=null),a.setAttribute("src",""),"mute"in A.param||t.setAttribute("src","")):"NOVIDEO"==e&&t.setAttribute("src","")}function S(e){"debug"in A.param?p.style.zIndex=g:p.style.zIndex=0,"VIDEO"==e?(l.style.backgroundColor=`rgb(0,0,0,${k})`,o.setAttribute("src","")):"NOVIDEO"==e&&(l.style.backgroundColor="rgb(0,0,0,0.0)",o.setAttribute("src","flow\\index.html"))}window.addEventListener("hashchange",()=>{D(!1)});let A={overparam:{},func:"default",body:"",param:{},id:"",extra:{}};function D(e){if(0!=e||0!=function(){var e=decodeURI(location.hash).substring(1);console.log("#"+e);try{let o=JSON.parse(e);return A={overparam:{},func:"default",body:"",param:{},id:"",extra:{}},Object.keys(o).forEach(e=>{e in A&&null!=o[e]&&(A[e]=o[e])}),Object.keys(A.overparam).forEach(e=>{A.param[e]=A.overparam[e]}),delete A.overparam,console.log("> Hash Verified."),console.log(A),!0}catch(e){return!1}}()){if("comment"==A.func){var l=A.body;let e=1;l.toLowerCase().startsWith("waa",5)&&(e=3,l=l.replace(l.substring(5,9),""));for(let i=0;i<e;i++){let e=$(`<p id="back">${l}</p>`),o=$(`<p id="front">${l}</p>`);var n=Math.random()*(window.innerHeight-200);let t=0;0<i&&(t=1e3*Math.random()),e.css("position","absolute"),e.css("left",window.innerWidth+t),e.css("top",n),e.css("white-space","pre"),o.css("position","absolute"),o.css("left",window.innerWidth+t),o.css("top",n),o.css("white-space","pre"),e.appendTo("body"),o.appendTo("body"),e.animate({left:-1*e.width()},7e3,"linear",function(){e.remove()}),o.animate({left:-1*o.width()},7e3,"linear",function(){o.remove()})}}else if("debug"==A.func)"0"==p.style.zIndex?(f=!0,p.style.zIndex=g):(f=!1,p.style.zIndex="0");else if("default"==A.func)if("que"in A.param)delete A.param.que,A.param.noreload=null,N.push(A),m="...QUE-REQUEST",""!=A.id&&(m+="@"+A.id),console.log(m),y(m),v();else if("cmd"in A.param){m="...CMD-REQUEST",""!=A.id&&(m+="@"+A.id),y(m),A.body=function(e){e=(e=e.replace(/[;\.\s]/g,"")).substring(0,-1==e.indexOf(")")?e.length:e.indexOf(")")+1);let o=-1;for(;-1!=(o=e.indexOf(",",o+1));){var t,i=e.indexOf(")",o);-1==i?e=e.replaceAt(o,""):(-1!=(t=e.indexOf("(",o))&&t<i||-1==t&&-1==e.indexOf("(",0))&&(e=e.replaceAt(o,""))}return e}(A.body);try{var o=`"use strict";player.${A.body};`;Function(o)(),console.log(o),y("CMD player."+A.body),v()}catch(e){console.log("CMD Failed"),y(e,h),y("...CMD Failed",h),v()}}else"help"in A.param?"youtube"==A.body.toLowerCase()&&(y(JSON.stringify(H,null,1)),v()):K();history.pushState(null,null," ")}}let N=[];function j(){console.log("> Session End!"),0<N.length&&(A=N.shift(),D(!0))}a.style.visibility="visible",D(!(s.style.visibility="visible"));