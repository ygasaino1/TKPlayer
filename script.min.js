let u=null;let s=document.querySelector("#video-iframe");let r=document.querySelector("#vid-container");let k=document.querySelector("#twitch-container");let c=null;let C=document.querySelector("#back-container");let t=document.querySelector("#back-iframe");let o=document.querySelector("audio");let f;let m=null;let d="";let l=document.querySelector("#console-input");let i=document.querySelector("#console");let n=document.querySelector("#console-flex");let j="#ffd3dc";let a="#00b1ff";let e;let z=1e3;let p=100;let q=.8;let h=false;function g(e,t=j){let o=w(`<div class="console" style="color: ${t}">${e}</div>`);l.appendChild(o);while(i.scrollHeight>i.clientHeight&&l.childNodes.length>2){l.childNodes[1].remove()}}function y(){i.style.zIndex=p;if(!h){clearTimeout(e);e=setTimeout(()=>{i.style.zIndex="0"},z)}}function w(e){var t=document.createElement("template");e=e.trim();t.innerHTML=e;return t.content.firstChild}String.prototype.replaceAt=function(e,t){return this.substring(0,e)+t+this.substring(e+1)};function M(){console.log(">> inside bilibili_main");console.log(m);console.log(V.param);let t=/\/video\/(\w+)|bvid=(\w+)/i;let o=decodeURI(m.href);let e="";let l="";if(t.test(o)){let e=o.match(t);l=e[1]||e[2]||""}let i=parseInt(m.searchParams.get("t"))||parseInt(m.searchParams.get("time"))||0;if("t"in V.param){i+=parseInt(V.param["t"])||0}e=`https://player.bilibili.com/player.html?&bvid=${l}&page=1&autoplay=1&t=${i}`;Q(e)}function Q(e){console.log(e);s.setAttribute("src",e);console.log(s)}function Y(){console.log(">> inside mixcloud_main");console.log(m);console.log(V.param);let t=/\/([\w-]+)\/([\w-]+)\/?$/i;let o=decodeURI(m.href);let e="";let l="";let i="";if(t.test(o)){let e=o.match(t);if(e.length>=3){if(e[1].toLowerCase()=="live"){l=e[2]||""}else{l=e[1]||"";i=e[2]||""}}else{U()}}let n=parseInt(m.searchParams.get("t"))||parseInt(m.searchParams.get("time"))||0;if("t"in V.param){n+=parseInt(V.param["t"])||0}if(l&&i){e=`https://www.mixcloud.com/widget/iframe/?feed=/${l}/${i}/`;s.setAttribute("src",e);if(!b){b=B()}b.then(()=>{u=Mixcloud.PlayerWidget(document.getElementById("video-iframe"));u.ready.then(function(){u.events.ended.on(()=>{if(D.length>0||!("loop"in V.param)){N()}else{u.seek(0);u.play()}});F(n)})})}else{U()}}function F(e){console.log(">> inside mixcloud_call");u.play();u.setOption("hide_cover",true);if(e!=0){u.seek(e)}}let b=null;function B(){return new Promise((e,t)=>{let o=document.createElement("script");o.id="mixcloud-script";o.src="https://widget.mixcloud.com/media/js/widgetApi.js";o.async=true;o.onload=()=>{e()};let l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(o,l);g("___ Mixcloud Initialization...")})}function H(){console.log(">> inside soundcloud_main");console.log(m);console.log(V.param);let e=decodeURI(m.href);let t=`https://w.soundcloud.com/player/?url=${e}&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true`;W(t)}function W(e){console.log(e);s.setAttribute("src",e);console.log(s)}function J(){console.log(">> inside twitch_main");console.log(m);console.log(V.param);u=null;let t=/^.*www\.twitch\.tv\/([^\?\/]+)$|.*\/\?channel=([^&]*)/i;let o=/.*\/\?video=(\w+)|.*\/videos\/([^?]*)/i;let l=/.*collection=(\w+)/i;let i=decodeURI(m.href);let e="";let n="";let s="";let a="";if(t.test(i)){let e=i.match(t);n=e[1]||e[2]||"";console.log(`twitch@channel_id: ${n}`)}if(o.test(i)){let e=i.match(o);s=e[1]||e[2]||"";console.log(`twitch@video_id: ${s}`)}if(l.test(i)){let e=i.match(l);a=e[1]||"";console.log(`twitch@collection_id: ${a}`)}e=`https://player.twitch.tv/?parent=${f.hostname}&autoplay=true`;if(n!=""){e+=`&channel=${n}`}if(s!=""){e+=`&video=${s}`}if(a!=""){e+=`&collection=${a}`}let r=0;let c=m.searchParams.get("t")||m.searchParams.get("time")||"";if(/^.*\D.*$/.test(c)){let e=c.match(/(\d*h)?(\d*m)?(\d*s)/i);r+=parseInt(e[1])*3600||0;r+=parseInt(e[2])*60||0;r+=parseInt(e[3])||0}else{r=parseInt(c)||0}if("t"in V.param){r+=parseInt(V.param["t"])||0}e+=`&time=${r}`;let d={autoplay:true,width:"100%",height:"100%"};if(n!=""){d.channel=n}else if(s!=""){d.video=s}else if(a!=""){d.collection=a}if(r!=0){d.time=`${r}`}u=new Twitch.Player("twitch-container",d);u.addEventListener(Twitch.Player.VIDEO_PLAY,v);u.addEventListener(Twitch.Player.ENDED,G)}function v(){console.log("twitch: Play");u.removeEventListener(Twitch.Player.VIDEO_PLAY,v);if(!("max"in V.param)){return}let e="twitch: Setting quality...";console.log(e);g(e);let t="Auto";e=`${u.getQualities().length} Qualities Present`;console.log(e);g(e);if(u.getQualities().length>1){e=`${u.getQualities()[1].group}`;console.log("quality: "+e);g("quality: "+e);u.setQuality(e)}}function G(){N()}function K(){console.log(">> inside vimeo_main");console.log(m);console.log(V.param);let e="";video_reg=/\/(\w+)[^\/]*$/i;let t=decodeURI(m.href);let o="";if(video_reg.test(t)){let e=t.match(video_reg);o=e[1]||e[2]||"";console.log(`vimeo@video_id: ${o}`)}if("loop"in V.param){e=`https://player.vimeo.com/video/${o}?autoplay=1&loop=1&autopause=0`}else{e=`https://player.vimeo.com/video/${o}?autoplay=1`}X(e)}function X(e){console.log(e);s.setAttribute("src",e);console.log(s)}function Z(){console.log(">> inside wistia_main");console.log(m);console.log(V.param);let e=decodeURI(m.href);let t="";ee(t)}function ee(e){console.log(e);s.setAttribute("src",e);console.log(s)}let te=`AIzaSyASq2_wSS45nCkxTy71WW5CKAhPzRn6pHU`;let I=null;let oe=["playVideo()","pauseVideo()","stopVideo()","clearVideo()","nextVideo()","previousVideo()","mute()","unMute()","setVolume(vol)","seekTo(time)","setPlaybackRate(rate)","showVideoInfo()","hideVideoInfo()"];function le(e){e=e.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/|\/shorts\/)/);return e[2]!==undefined?e[2].split(/[^0-9a-z_\-]/i)[0]:e[0]}let _=-1;function ie(){console.log(">> inside youtube_main");console.log(m);console.log(V.param);let l=decodeURI(m.href);let i="";let e="";let n="";if("list"in V.param||m.pathname.toLowerCase().includes("videoseries")){if(!l.includes("list=LL")&&!l.toLowerCase().includes("start_radio=1")){if(m.searchParams.has("playlist")){e=m.searchParams.get("playlist")}if(m.searchParams.has("list")){e=m.searchParams.get("list")}if("loop"in V.param){i=`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&loop=1&`}else{i=`https://www.youtube.com/embed/videoseries?list=${e}&enablejsapi=1&controls=0&`}}}else if(e==""){n=le(l);console.log(`youtube@video_id: ${n}`);let e=parseInt(m.searchParams.get("t"))||parseInt(m.searchParams.get("time"))||0;if("t"in V.param){e+=parseInt(V.param["t"])||0}_=-1;let t=e;let o=-1;if("crop"in V.param){let e=V.param["crop"].split("-");try{_=Number(e[0]);t+=Number(e[0])}catch(e){g(e)}try{if(e.length>1){o=Number(e[1])}}catch(e){g(e)}}i=`https://www.youtube.com/embed/${n}?enablejsapi=1&controls=0&start=${t}`;if(o!=-1){i+=`&end=${o}`}}if("mute"in V.param){i+="&mute=1"}I=V.param;ne(i)}function ne(e){console.log(e);s.setAttribute("src",e);if(!E){R()}console.log(s)}let E=false;function R(){let e=document.createElement("script");e.id="iframe-demo";e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t);E=true}function onYouTubeIframeAPIReady(){let e={events:{onReady:se,onStateChange:ae}};u=new YT.Player("video-iframe",e)}function se(e){u.playVideo();re();ce()}if(s.getAttribute("src")!="no-source"){R()}let O=[0,0,0];function ae(e){O.unshift(e.data);O.pop();if(O[0]==YT.PlayerState.PLAYING&&O[1]==YT.PlayerState.BUFFERING&&O[2]==YT.PlayerState.UNSTARTED){t()}if(e.data==YT.PlayerState.ENDED&&D.length>0){N()}else if(e.data==YT.PlayerState.ENDED&&"loop"in I&&!("list"in I)){u.playVideo();if(_!=-1){u.seekTo(_)}}function t(){let e=u.videoTitle;document.title=e;g(`___ [${e}]`);g(`___ [${u.getDuration()}]`)}}function re(){let o=null;Object.keys(V.param).forEach(e=>{let t=e.match(/^(\d+\.?\d*)x$/i);if(t&&t.length>1){o=Number(t[1])}});if(o){u.setPlaybackRate(o)}}function ce(){let o=null;let e=false;Object.keys(V.param).forEach(e=>{let t=e.match(/^(\d+\.?\d*)v$/i);if(t&&t.length>1){o=Number(t[1])}});if(o){if(o<0){o=0}if(o>100){o=100}u.setVolume(o)}}function de(){console.log(">> inside zeno_main");console.log(m);console.log(V.param);let t=decodeURI(m.href);let e="";let o="";radio_reg=/\/(\w+)\/?$/i;if(radio_reg.test(t)){let e=t.match(radio_reg);o=e[1]||"";console.log(`zeno@radio_id: ${o}`)}e=`https://zeno.fm/player/${o}`;ue(e)}function ue(e){console.log(e);s.setAttribute("src",e);console.log(s)}function fe(n){let s=7e3;let e=1;if(n.toLowerCase().startsWith("waa",5)){e=3;n=n.replace(n.substring(5,9),"")}for(let i=0;i<e;i++){let e=$(`<p id="back">${n}</p>`);let t=$(`<p id="front">${n}</p>`);let o=Math.random()*(window.innerHeight-200);let l=0;if(i>0){l=Math.random()*1e3}e.css("position","absolute");e.css("left",window.innerWidth+l);e.css("top",o);e.css("white-space","pre");t.css("position","absolute");t.css("left",window.innerWidth+l);t.css("top",o);t.css("white-space","pre");e.appendTo("body");t.appendTo("body");e.animate({left:e.width()*-1},s,"linear",function(){e.remove()});t.animate({left:t.width()*-1},s,"linear",function(){t.remove()})}}function U(){console.log(">> inside direct");console.log(m);console.log(V.param);let e=decodeURI(m.href);me(e)}function me(e){console.log(e);window.location.href=e}function pe(){console.log(">> inside audio_main");console.log(m);console.log(V.param);let e=decodeURI(m.href);he(e)}function he(e){d="Radio Loading...";g(d);console.log(e);o.setAttribute("src",e);o.play();console.log(o)}u=null;function ge(){console.log(">> inside video_main");console.log(m);console.log(V.param);let l=decodeURI(m.href);let e=`<video-js id="my-video" class="video-js" style="position: absolute; top:0; left:0; height:100%; width:100%" autoplay preload="auto"></video-js>`;c=w(e);console.log(c);r.appendChild(c);d="Video Loading...";g(d);u=videojs(document.querySelector("#my-video"));let t={m3u8:"application/x-mpegURL",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg"};let i=l;let o="";let n="";let s=false;Object.keys(t).forEach(e=>{if(!s&&i.toLowerCase().includes(e)){o=e;s=true}});let a=false;Object.keys(t).forEach(e=>{if(!a&&e in V.param){o=e;a=true}});if(o in t){n=t[o];u.ready(function(){console.log(`VideoJs is Ready...`);g(`___ [${n}]`);console.log(`___ [${n}]`);console.log(`[SRC] ${i}`);let e={type:n,src:i};console.log(e);u.src(e);let t=new URL(l);let o=parseInt(t.searchParams.get("t"))||parseInt(t.searchParams.get("time"))||0;if("t"in V.param){o+=parseInt(V.param["t"])||0}this.currentTime(o)})}u.on("ended",function(){videojs.log("Awww...over so soon?!");c.remove();c=null;N()})}let ye="https://prrr-001.glitch.me/";let we=window.location.href;let be="";let P=0;f=new URL(location);let S={};let x={youtube:/(.*youtube\..*)|(.*youtu\.be.*)/i,twitch:/.*\.twitch\..*/i,vimeo:/.*vimeo\.\w+\//i,soundcloud:/\w*.?soundcloud\.\w+/i,bilibili:/\.bilibili\./i,zeno:/zeno/i,mixcloud:/\.mixcloud\./i,video:/\.mp4|\.m3u8|\.webm|\.ogv/i};let L={radio:pe};function ve(){let e=V.body;d=`...REQUEST`;if(V.id!=""){d+=`@${V.id}`}g(d);try{m=null;if(e=="off"){e=we;m=new URL(e);g(`URL off`)}else if(e=="homepage"){e=ye;m=new URL(e);g(`URL homepage`)}else{m=new URL(e);if(m.host==location.host||"-"in V.param){d=`URL [*][*][*][*][*] -{___}`}else{d=`URL [${m.protocol}//][${m.host}][${m.pathname}][${m.search}][${m.hash}] -${JSON.stringify(V.param)}`}g(d)}$e();y()}catch(e){console.log("URL Failed");if(m==null){g(`URL ${V.body} -${JSON.stringify(V.param)}`,a)}g(e,a);g("...URL Failed",a);y()}}function $e(){if(["radio"].some(e=>e in V.param)){A("NOVIDEO");Ie("NOVIDEO");_e("NOVIDEO");Re()}else{A("VIDEO");Ie("VIDEO");_e("VIDEO");Ee()}}function A(e){if(P>0&&!("noreload"in V.param)){window.location.reload()}if(e=="VIDEO"){P+=1}}function Ie(e){if(e=="VIDEO"){{if(c!=null){c.remove();c=null}s.setAttribute("src","")}if(!("mute"in V.param)){o.setAttribute("src","")}}else if(e=="NOVIDEO"){o.setAttribute("src","")}}function _e(e){if("debug"in V.param){i.style.zIndex=p}else{i.style.zIndex=0}if(e=="VIDEO"){n.style.backgroundColor=`rgb(0,0,0,${q})`;t.setAttribute("src","")}else if(e=="NOVIDEO"){n.style.backgroundColor=`rgb(0,0,0,0.0)`;t.setAttribute("src","flow\\index.html")}}function Ee(){let e=Object.keys(S).filter(e=>e in V.param)[0];if(e!=undefined){S[e]()}else if(x["youtube"].test(m.host)){ie()}else if(x["twitch"].test(m.host)){J()}else if(x["vimeo"].test(m.host)){K()}else if(x["soundcloud"].test(m.host)){H()}else if(x["bilibili"].test(m.host)){M()}else if(x["zeno"].test(decodeURI(m.host))){de()}else if(x["mixcloud"].test(decodeURI(m.host))){Y()}else if(x["video"].test(decodeURI(m.href))){ge()}else{U()}}function Re(){let e=Object.keys(L).filter(e=>e in V.param)[0];if(e!=undefined){L[e]()}}function Oe(){if(i.style.zIndex=="0"){h=true;i.style.zIndex=p}else{h=false;i.style.zIndex="0"}}window.addEventListener("hashchange",()=>{T(false)});let V={overparam:{},func:"default",body:"",param:{},id:"",extra:{}};function T(e){if(e==false&&Ue()==false){return}if(V.func=="comment"){fe(V.body)}else if(V.func=="debug"){Oe()}else if(V.func=="default"){if("que"in V.param){Pe()}else if("cmd"in V.param){Se()}else if("help"in V.param){Le()}else{ve()}}history.pushState(null,null," ")}function Ue(){let e=decodeURI(location.hash).substring(1);console.log(`#${e}`);try{let t=JSON.parse(e);V={overparam:{},func:"default",body:"",param:{},id:"",extra:{}};Object.keys(t).forEach(e=>{if(e in V&&t[e]!=null){V[e]=t[e]}});Object.keys(V.overparam).forEach(e=>{V.param[e]=V.overparam[e]});delete V.overparam;console.log("> Hash Verified.");console.log(V);return true}catch(e){return false}}let D=[];function Pe(){delete V.param.que;V.param["noreload"]=null;D.push(V);d=`...QUE-REQUEST`;if(V.id!=""){d+=`@${V.id}`}console.log(d);g(d);y()}function N(){console.log("> Session End!");if(D.length>0){V=D.shift();T(true)}}function Se(){d=`...CMD-REQUEST`;if(V.id!=""){d+=`@${V.id}`}g(d);V.body=xe(V.body);try{let e=`"use strict";player.${V.body};`;Function(e)();console.log(e);g(`CMD player.${V.body}`);y()}catch(e){console.log("CMD Failed");g(e,a);g("...CMD Failed",a);y()}}function xe(o){o=o.replace(/[;\.\s]/g,"");o=o.substring(0,o.indexOf(")")==-1?o.length:o.indexOf(")")+1);let l=-1;while((l=o.indexOf(",",l+1))!=-1){let e=o.indexOf(")",l);if(e==-1){o=o.replaceAt(l,"");continue}let t=o.indexOf("(",l);if(t!=-1&&t<e){o=o.replaceAt(l,"");continue}if(t==-1&&o.indexOf("(",0)==-1){o=o.replaceAt(l,"");continue}}return o}function Le(){if(V.body.toLowerCase()=="youtube"){g(JSON.stringify(oe,null,1));y()}}s.style.visibility="visible";r.style.visibility="visible";T(false);